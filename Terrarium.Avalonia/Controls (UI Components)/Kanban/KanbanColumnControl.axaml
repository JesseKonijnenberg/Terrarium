<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Terrarium.Avalonia.ViewModels"
             xmlns:behaviors="using:Terrarium.Avalonia.Behaviors"
             xmlns:views="using:Terrarium.Avalonia.Views"
             xmlns:kanban="clr-namespace:Terrarium.Avalonia.Models.Kanban"
             xmlns:controlsUiComponents="clr-namespace:Terrarium.Avalonia.Controls__UI_Components_"
             x:Class="Terrarium.Avalonia.Controls.KanbanColumnControl"
             x:DataType="kanban:Column">

    <Border Width="320" Background="Transparent"
            behaviors:KanbanDropHandler.IsDropTarget="True">
        
        <Grid RowDefinitions="Auto, *, Auto">
            <Grid Grid.Row="0" Margin="0,0,0,20" ColumnDefinitions="Auto, Auto, *, Auto">
                <TextBlock Text="{Binding Title}" Foreground="{StaticResource AccentSage}" FontFamily="Georgia" FontStyle="Italic" FontSize="18"/>
                <Border Grid.Column="1" Margin="10,0,0,0" Background="{StaticResource BgSidebar}" BorderBrush="#33302c" BorderThickness="1" CornerRadius="4" Padding="8,2">
                    <TextBlock Text="{Binding TaskCount}" Foreground="{StaticResource TextMuted}" FontSize="11" FontWeight="Bold"/>
                </Border>
                <Path Grid.Column="3" Data="{StaticResource IconMore}" Stroke="{StaticResource TextMuted}" Margin="10,0" StrokeThickness="2" Width="20" Height="20"/>
            </Grid>

            <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Disabled">
                <ItemsControl ItemsSource="{Binding Tasks}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <controlsUiComponents:TaskCardControl/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>

            <Button Grid.Row="2" Margin="0,15,0,0" Height="45" Background="Transparent" 
                    BorderBrush="{StaticResource BorderColor}" BorderThickness="1" CornerRadius="8" HorizontalAlignment="Stretch"
                    Command="{Binding $parent[views:KanbanBoardView].((vm:KanbanBoardViewModel)DataContext).AddItemCommand}"
                    CommandParameter="{Binding .}">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="8">
                    <Path Data="{StaticResource IconPlus}" Stroke="{StaticResource TextMuted}" StrokeThickness="2" Width="12" Height="22.5"/>
                    <TextBlock Text="Add Item" Foreground="{StaticResource TextMuted}" FontSize="12" Margin="10,0" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
        </Grid>
    </Border>
</UserControl>