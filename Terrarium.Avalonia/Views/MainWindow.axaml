<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="using:Terrarium.Avalonia.ViewModels"
        mc:Ignorable="d" d:DesignWidth="400" d:DesignHeight="650"
        x:Class="Terrarium.Avalonia.Views.MainWindow"
        x:DataType="vm:PlantViewModel"
        
        Title="My Tiny Terrarium"
        Width="400" Height="650"
        
        SystemDecorations="None"
        Background="Transparent"
        TransparencyLevelHint="Transparent"
        
        WindowStartupLocation="CenterScreen"
        Topmost="True">

    <Window.Styles>
        <Style Selector="ProgressBar.Cute">
            <Setter Property="Height" Value="25"/>
            <Setter Property="Foreground" Value="#FF88C0D0"/>
            <Setter Property="Background" Value="#FFE5E5E5"/>
            <Setter Property="Template">
                <ControlTemplate>
                    <Grid>
                        <Border Name="PART_Track" CornerRadius="12" Background="{TemplateBinding Background}"/>
                        <Border Name="PART_Indicator" CornerRadius="12" HorizontalAlignment="Left" Background="{TemplateBinding Foreground}"/>
                    </Grid>
                </ControlTemplate>
            </Setter>
        </Style>

        <Style Selector="Button.Cute">
            <Setter Property="Background" Value="#FF88C0D0"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="CornerRadius" Value="20"/>
            <Setter Property="Padding" Value="10"/>
            
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>

            <Setter Property="Transitions">
                <Transitions>
                    <BrushTransition Property="Background" Duration="0:0:0.2"/>
                </Transitions>
            </Setter>
        </Style>
        <Style Selector="Button.Cute:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="#FF81A1C1"/>
        </Style>
        <Style Selector="Button.Cute:pressed /template/ ContentPresenter">
            <Setter Property="Background" Value="#FF5E81AC"/>
        </Style>

        <Style Selector="Button.Close">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#FFBF616A"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Opacity" Value="0"/>
            <Setter Property="Transitions">
                <Transitions>
                    <DoubleTransition Property="Opacity" Duration="0:0:0.2"/>
                </Transitions>
            </Setter>
        </Style>
        
        <Style Selector="Window:pointerover Button.Close">
            <Setter Property="Opacity" Value="0.4"/>
        </Style>
        
        <Style Selector="Button.Close:pointerover">
            <Setter Property="Opacity" Value="1"/>
            <Setter Property="Background" Value="#10000000"/>
        </Style>

        <Style Selector="Path.ResizeGrip">
            <Setter Property="Opacity" Value="0"/>
            <Setter Property="Transitions">
                <Transitions>
                    <DoubleTransition Property="Opacity" Duration="0:0:0.2"/>
                </Transitions>
            </Setter>
        </Style>
        
        <Style Selector="Window:pointerover Path.ResizeGrip">
            <Setter Property="Opacity" Value="0.5"/>
        </Style>
        
    </Window.Styles>

    <Grid Background="#01FFFFFF" PointerPressed="Window_PointerPressed">

        <Button Classes="Close"
                HorizontalAlignment="Right"
                VerticalAlignment="Top"
                Width="30" Height="30"
                Margin="10"
                Content="✕"
                Cursor="Hand"
                Click="CloseButton_Click"/>

        <Viewbox Stretch="Uniform">
            <Border Padding="20">
                <StackPanel VerticalAlignment="Center">

                    <Border Background="White" CornerRadius="15" Padding="15,8" Margin="0,0,0,15" HorizontalAlignment="Center" MinWidth="150">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="15" Opacity="0.1" OffsetX="3" OffsetY="3" Color="#FF81A1C1"/>
                        </Border.Effect>
                        <TextBlock Text="{Binding CurrentWeatherText}" 
                                   HorizontalAlignment="Center"
                                   FontSize="16" 
                                   Foreground="#FF2E3440" 
                                   FontFamily="Segoe UI Semibold"/>
                    </Border>

                    <Image Source="{Binding PlantImage}" 
                           Height="180" Width="180" 
                           Margin="0,0,0,10"
                           RenderOptions.BitmapInterpolationMode="HighQuality">
                        
                        <Image.RenderTransform>
                            <TranslateTransform Y="0"/>
                        </Image.RenderTransform>
                        
                        <Image.Styles>
                            <Style Selector="Image">
                                <Style.Animations>
                                    <Animation Duration="0:0:3" IterationCount="Infinite" PlaybackDirection="Alternate"> 
                                        <KeyFrame Cue="0%">
                                            <Setter Property="TranslateTransform.Y" Value="0"/>
                                        </KeyFrame>
                                        <KeyFrame Cue="100%">
                                            <Setter Property="TranslateTransform.Y" Value="-6"/>
                                        </KeyFrame>
                                    </Animation>
                                </Style.Animations>
                            </Style>
                        </Image.Styles>
                    </Image>

                    <TextBlock Text="{Binding StatusMessage}" 
                               HorizontalAlignment="Center"
                               FontSize="18" FontWeight="Bold" Foreground="White"
                               Margin="0,0,0,20">
                        <TextBlock.Effect>
                            <DropShadowEffect Color="Black" BlurRadius="4" OffsetX="0" OffsetY="0" Opacity="0.8"/>
                        </TextBlock.Effect>
                    </TextBlock>

                    <Grid Margin="0,0,0,10" ColumnDefinitions="Auto, *">
                        <StackPanel Orientation="Horizontal" Width="80">
                            <TextBlock Text="Water" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="White">
                                <TextBlock.Effect>
                                    <DropShadowEffect Color="Black" BlurRadius="3" OffsetX="0" OffsetY="0" Opacity="0.6"/>
                                </TextBlock.Effect>
                            </TextBlock>
                        </StackPanel>
                        <ProgressBar Grid.Column="1" Classes="Cute"
                                     Value="{Binding Hydration}" Maximum="100"
                                     Foreground="#FF88C0D0"/>
                    </Grid>

                    <Grid Margin="0,0,0,10" ColumnDefinitions="Auto, *">
                        <StackPanel Orientation="Horizontal" Width="80">
                            <TextBlock Text="Sun" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="White">
                                <TextBlock.Effect>
                                    <DropShadowEffect Color="Black" BlurRadius="3" OffsetX="0" OffsetY="0" Opacity="0.6"/>
                                </TextBlock.Effect>
                            </TextBlock>
                        </StackPanel>
                        <ProgressBar Grid.Column="1" Classes="Cute"
                                     Value="{Binding Sunlight}" Maximum="100"
                                     Foreground="#FFEBCB8B"/>
                    </Grid>

                    <Button Classes="Cute"
                            Command="{Binding WaterCommand}" 
                            Content="Water Plant" 
                            HorizontalAlignment="Center"
                            Width="180" Height="45" 
                            Margin="0,20,0,0"
                            Cursor="Hand">
                         <Button.Effect>
                            <DropShadowEffect BlurRadius="10" Opacity="0.2" OffsetX="3" OffsetY="3" Color="#FF88C0D0"/>
                        </Button.Effect>
                    </Button>

                </StackPanel>
            </Border>
        </Viewbox>

        <Path Classes="ResizeGrip"
              HorizontalAlignment="Right" VerticalAlignment="Bottom"
              Width="15" Height="15" Margin="5"
              Fill="#80000000"
              Data="M15,15 L15,5 L5,15 Z"
              Cursor="BottomRightCorner"
              PointerPressed="ResizeGrip_PointerPressed"/>
        
    </Grid>
</Window>