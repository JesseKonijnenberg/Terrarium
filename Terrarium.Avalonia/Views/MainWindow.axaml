<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        
        xmlns:vm="using:Terrarium.Avalonia.ViewModels"
        xmlns:controls="using:Terrarium.Avalonia.Controls"
        
        mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="800"
        x:Class="Terrarium.Avalonia.Views.MainWindow"
        x:DataType="vm:KanbanBoardViewModel"
        
        Title="Kanban Dashboard"
        Width="1200" Height="800"
        Background="{StaticResource BgMain}"
        FontFamily="Segoe UI, Inter, Sans-Serif"
        WindowStartupLocation="CenterScreen">

    <Grid ColumnDefinitions="80, *">
        
        <controls:SidebarControl Grid.Column="0"/>

        <Grid Grid.Column="1" RowDefinitions="80, *">
            
            <controls:TopBarControl Grid.Row="0"/>

            <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled">
                <ItemsControl ItemsSource="{Binding Columns}" Margin="30">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal" Spacing="30"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <controls:KanbanColumnControl/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>

            <Grid Grid.RowSpan="2" HorizontalAlignment="Right" Width="450" 
                  Background="{StaticResource BgSidebar}"
                  IsVisible="{Binding IsDetailPanelOpen}">
                
                <Grid.Effect>
                    <DropShadowEffect BlurRadius="30" Color="Black" Opacity="0.5" OffsetX="-5"/>
                </Grid.Effect>

                <Border BorderBrush="{StaticResource BorderColor}" BorderThickness="1,0,0,0">
                    <Grid RowDefinitions="80, *, Auto">
                        <Border BorderBrush="{StaticResource BorderColor}" BorderThickness="0,0,0,1" Padding="30,0">
                            <Grid ColumnDefinitions="*, Auto">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="{Binding SelectedTask.Id, StringFormat='#{0}'}" Foreground="{StaticResource AccentSage}" FontFamily="Georgia" FontStyle="Italic" VerticalAlignment="Center"/>
                                    <TextBlock Text="DETAIL VIEW" Foreground="{StaticResource TextMuted}" FontSize="10" FontWeight="Bold" VerticalAlignment="Center"/>
                                </StackPanel>
                                <Button Grid.Column="1" Content="✕" Foreground="{StaticResource TextMuted}" Background="Transparent" Command="{Binding CloseDetails}"/>
                            </Grid>
                        </Border>

                        <StackPanel Grid.Row="1" Margin="30" Spacing="20">
                            <TextBlock Text="{Binding SelectedTask.Content}" Foreground="{StaticResource TextMain}" FontFamily="Georgia" FontSize="28" TextWrapping="Wrap"/>
                            <StackPanel Orientation="Horizontal" Spacing="15">
                                <Border Background="{Binding SelectedTask.TagBgColor}" CornerRadius="10" Padding="12,2">
                                    <TextBlock Text="{Binding SelectedTask.Tag}" Foreground="{Binding SelectedTask.TagTextColor}" FontWeight="Bold" FontSize="10"/>
                                </Border>
                                <TextBlock Text="{Binding SelectedTask.Date, StringFormat='Due {0}'}" Foreground="{StaticResource TextMuted}" VerticalAlignment="Center" FontSize="12"/>
                            </StackPanel>
                            <TextBlock Text="BRIEF" Foreground="{StaticResource TextMuted}" FontSize="10" FontWeight="Bold" Margin="0,10,0,0"/>
                            <TextBlock Text="This is a placeholder description..." Foreground="#d6ccc2" LineHeight="24" TextWrapping="Wrap"/>
                        </StackPanel>

                        <Border Grid.Row="2" Background="{StaticResource BgSidebar}" BorderBrush="{StaticResource BorderColor}" BorderThickness="0,1,0,0" Padding="20">
                            <Border Background="{StaticResource BgMain}" CornerRadius="8" Height="50" BorderBrush="{StaticResource BorderColor}" BorderThickness="1">
                                <TextBlock Text="Type a note..." Foreground="#5c5652" VerticalAlignment="Center" Margin="15,0"/>
                            </Border>
                        </Border>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </Grid>
</Window>